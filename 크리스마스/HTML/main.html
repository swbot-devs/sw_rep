<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>í–¥ì¼ê³  ì œ14ëŒ€ í•™ìƒìì¹˜íšŒ</title>

<style>
/* í°íŠ¸ ë“±ë¡ */
/* Cafe24 í°íŠ¸ */
@font-face {
    font-family: 'Cafe24Ssurround';
    src: url('Cafe24Ssurround-v2.0.woff2') format('woff2'),
         url('Cafe24Ssurround-v2.0.woff') format('woff');
    font-weight: normal;
    font-style: normal;
}

/* Paperlogy í°íŠ¸ (í¬ë ˆë”§ìš©) */
@font-face {
    font-family: 'Paperlogy';
    src: url('Paperlogy-5Medium.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
}


/* ê¸°ë³¸ */
body {
    margin: 0;
    font-family: 'Cafe24Ssurround', sans-serif;
    background: linear-gradient(#0b3d2e, #145a32);
    color: white;
    text-align: center;
    height: 100vh;
}

.container {
    padding-top: 120px;
}


/* ê³µí†µ ìš”ì†Œ */
h1 {
    font-size: 42px;
    margin-bottom: 10px;
}

input {
    font-size: 28px;
    padding: 12px;
    width: 220px;
    text-align: center;
    border-radius: 10px;
    border: none;
    font-family: inherit;
}

button {
    font-size: 22px;
    padding: 12px 30px;
    margin-top: 15px;
    border-radius: 30px;
    border: none;
    background: #e74c3c;
    color: white;
    font-family: inherit;
}

.hidden {
    display: none;
}


/* ê²°ê³¼ í™”ë©´ */
.result {
    font-size: 60px;
    margin-top: 50px;
}

.countdown {
    margin-top: 15px;
    font-size: 18px;
    opacity: 0.8;
    animation: jump 1s infinite;
}


/* ê´€ë¦¬ì ë²„íŠ¼ */
#adminBtn {
    position: fixed;
    right: 20px;
    bottom: 20px;
    width: 76px;
    height: 76px;
    border-radius: 50%;
    background: white;
    border: none;
    padding: 6px;
    box-shadow: 0 0 10px rgba(255,255,255,0.6);
}

#adminBtn img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    border-radius: 50%;
}


/* ê´€ë¦¬ì íŒ¨ë„ */
#adminPanel {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.8);
    display: none;
}

#adminBox {
    position: relative;
    background: white;
    color: black;
    width: 300px;
    padding: 20px;
    border-radius: 20px;
    margin: 150px auto;
}

#closeX {
    position: absolute;
    top: 10px;
    right: 14px;
    background: none;
    border: none;
    font-size: 22px;
    cursor: pointer;
    color: #555;
}


/* ê´€ë¦¬ì ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
.btn-main {
    background: #e74c3c;
    color: white;
    font-size: 20px;
    padding: 14px;
    width: 100%;
    border-radius: 30px;
    border: none;
    margin-top: 10px;
}

.btn-close {
    background: #888;
    color: white;
    font-size: 18px;
    padding: 12px;
    width: 100%;
    border-radius: 30px;
    border: none;
}

.btn-close:hover {
    background: #555;
}


/* ì• ë‹ˆë©”ì´ì…˜ */
@keyframes jump {
    0%   { transform: translateY(0); }
    50%  { transform: translateY(-4px); }
    100% { transform: translateY(0); }
}


/* ì œì‘ì í‘œì‹œ */
#credit {
    position: fixed;
    left: 20px;
    bottom: 20px;
    font-size: 18px;
    opacity: 0.95;
    text-align: left;
    font-family: 'Paperlogy', sans-serif;
}

#credit .name {
    font-size: 20px;
    font-weight: bold;
    color: #ffd966;
}


</style>
</head>

<body>

<div class="container" id="inputScreen">
    <h1>ğŸ„ í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ë³´ë¬¼ì°¾ê¸° ğŸ„</h1>
    <h2>í•™ë²ˆì„ ì…ë ¥í•˜ì„¸ìš”</h2>
    <input inputmode="numeric" id="code" maxlength="5" placeholder="00000">
    <br>
    <button onclick="saveCode()">í™•ì¸</button>
</div>

<div class="container hidden" id="successScreen">
    <div class="result">ğŸ<br>ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.</div>
    <p id="countdownSuccess" class="countdown">3ì´ˆ í›„ ëŒì•„ê°‘ë‹ˆë‹¤.</p>
    <button onclick="goHome()">ëŒì•„ê°€ê¸°</button>
</div>


<div class="container hidden" id="failScreen">
    <div class="result">âŒ<br>ì´ë¯¸ ì°¸ì—¬í•¨</div>
    <p id="countdownFail" class="countdown">3ì´ˆ í›„ ëŒì•„ê°‘ë‹ˆë‹¤.</p>
    <button onclick="goHome()">ëŒì•„ê°€ê¸°</button>
</div>


<!-- ê´€ë¦¬ì ë²„íŠ¼ -->
<button id="adminBtn" onclick="openAdmin()">
    <img src="í–¥ì¼ê³ ë“±í•™êµ.png" alt="ì„¤ì •">
</button>

<!-- ê´€ë¦¬ì íŒ¨ë„ -->
<div id="adminPanel">
    <div id="adminBox">
        <button id="closeX" onclick="closeAdmin()">âœ•</button>
        <h3>ê´€ë¦¬ì</h3>

        <div id="pwArea">
            <input inputmode="numeric" type="password" id="adminPw" placeholder="ë¹„ë°€ë²ˆí˜¸">
            <br>
            <button onclick="checkPw()">í™•ì¸</button>
            <button onclick="closeAdmin()">ë‹«ê¸°</button>
        </div>

        <div id="adminMenu" class="hidden">
            <button onclick="resetAll()">ì „ì²´ ì´ˆê¸°í™”</button>
            <br><br>
            <button onclick="openEdit()">ê¸°ë¡ ìˆ˜ì •</button>
            <br><br>
            <button onclick="openResult()">ê²°ê³¼ ì·¨í•©</button>
            <br><br>
            <button class="btn-close" onclick="closeAdmin()">ë‹«ê¸°</button>
        </div>

        <div id="editArea" class="hidden">
            <h4>ê¸°ë¡ ìˆ˜ì •</h4>

            <input inputmode="numeric" id="editCode" maxlength="5" placeholder="í•™ë²ˆ ì…ë ¥">
            <br>

            <button class="btn-main" onclick="openEditChoice()">ìˆ˜ì •</button>
            <button class="btn-main" onclick="deleteOne()">ì‚­ì œ</button>

            <br><br>
            <button class="btn-close" onclick="closeAdmin()">ë‹«ê¸°</button>
        </div>

        <div id="editChoice" class="hidden">
            <p><b>ì–´ë–»ê²Œ ìˆ˜ì •í• ê¹Œìš”?</b></p>

            <button class="btn-main" onclick="enableRetry()">
                ë‹¤ì‹œ ì°¸ì—¬ ê°€ëŠ¥í•˜ê²Œ
            </button>

            <p style="margin:15px 0 5px;">ë³€ê²½í•  í•™ë²ˆ</p>
            <input inputmode="numeric" id="newCode" maxlength="5" placeholder="00000">

            <button class="btn-main" onclick="changeCode()">í•™ë²ˆ ë³€ê²½</button>

            <br><br>
            <button class="btn-close" onclick="backToEdit()">ì·¨ì†Œ</button>
        </div>

        <div id="editChoice" class="hidden">
            <p><b>ì–´ë–»ê²Œ ìˆ˜ì •í• ê¹Œìš”?</b></p>
            <button onclick="enableRetry()">ë‹¤ì‹œ ì°¸ì—¬ ê°€ëŠ¥í•˜ê²Œ</button>
            <br>
            <input inputmode="numeric" id="newCode" maxlength="5" placeholder="ë³€ê²½í•  í•™ë²ˆ">
            <br>
            <button onclick="changeCode()">í•™ë²ˆ ë³€ê²½</button>
            <br><br>
            <button class="btn-close" onclick="closeAdmin()">ì·¨ì†Œ</button>
        </div>

        <div id="resultArea" class="hidden">
            <h4>ê²°ê³¼ ì·¨í•©</h4>

            <div id="resultList"
                style="max-height:300px; overflow:auto; font-size:14px; text-align:left;">
            </div>

            <button class="btn-main" onclick="copyResult()">ë³µì‚¬í•˜ê¸°</button>
            <button class="btn-main" onclick="downloadCSV()">CSV íŒŒì¼ ë‹¤ìš´ë¡œë“œ</button>
            <br><br>
            <button class="btn-close" onclick="closeAdmin()">ë‹«ê¸°</button>
        </div>


    </div>
</div>

<script>
const ADMIN_PASSWORD = "8180";

/* ì €ì¥ ë°ì´í„° */
function getCodes() {
    return JSON.parse(localStorage.getItem("codes")) || [];
}
function setCodes(codes) {
    localStorage.setItem("codes", JSON.stringify(codes));
}

/* ì €ì¥ */
function saveCode() {
    const code = document.getElementById("code").value;

    if (!/^\d{5}$/.test(code)) {
        alert("5ìë¦¬ ìˆ«ìë§Œ ì…ë ¥í•˜ì„¸ìš”");
        return;
    }

    const codes = getCodes();
    if (codes.some(c => c.code === code)) {
        show("fail");
        return;
    }

    codes.push({ code, time: Date.now() });
    setCodes(codes);
    show("success");
}

/* í™”ë©´ ì „í™˜ */
let timer = null;

function show(type) {
    ["input","success","fail"].forEach(id =>
        document.getElementById(id + "Screen").classList.add("hidden")
    );
    document.getElementById(type + "Screen").classList.remove("hidden");

    if (type !== "input") startCountdown(type);
}

function startCountdown(type) {
    let count = 15;
    const el = document.getElementById(
        type === "success" ? "countdownSuccess" : "countdownFail"
    );

    clearInterval(timer);
    el.textContent = `${count}ì´ˆ í›„ ëŒì•„ê°‘ë‹ˆë‹¤.`;

    timer = setInterval(() => {
        count--;
        el.textContent = `${count}ì´ˆ í›„ ëŒì•„ê°‘ë‹ˆë‹¤.`;
        if (count === 0) {
            clearInterval(timer);
            goHome();
        }
    }, 1000);
}

function goHome() {
    document.getElementById("code").value = "";
    show("input");
}

/* ê´€ë¦¬ì UI ì´ˆê¸°í™” */
function resetAdminUI() {
    document.getElementById("adminPanel").style.display = "none";
    ["pwArea","adminMenu","editArea","editChoice","resultArea"]
        .forEach(id => document.getElementById(id).classList.add("hidden"));
    ["adminPw","editCode","newCode"].forEach(id => {
        const el = document.getElementById(id);
        if (el) el.value = "";
    });
}

function openAdmin() {
    resetAdminUI();
    document.getElementById("adminPanel").style.display = "block";
    document.getElementById("pwArea").classList.remove("hidden");
}

function closeAdmin() {
    resetAdminUI();
}

/* ê´€ë¦¬ì ë¡œê·¸ì¸ */
function checkPw() {
    if (document.getElementById("adminPw").value !== ADMIN_PASSWORD) {
        alert("ë¹„ë°€ë²ˆí˜¸ ì˜¤ë¥˜");
        return;
    }
    document.getElementById("pwArea").classList.add("hidden");
    document.getElementById("adminMenu").classList.remove("hidden");
}

/* ì „ì²´ ì´ˆê¸°í™” */
function resetAll() {
    if (!confirm("ëª¨ë‘ ì´ˆê¸°í™”í• ê¹Œìš”?")) return;
    localStorage.removeItem("codes");
    alert("ì´ˆê¸°í™” ì™„ë£Œ");
    closeAdmin();
}

function openEdit() {
    document.getElementById("adminMenu").classList.add("hidden");
    document.getElementById("editArea").classList.remove("hidden");
}

/* ê¸°ë¡ ìˆ˜ì • ì„ íƒ */
function openEditChoice() {
/* ê¸°ë¡ ìˆ˜ì • ì„ íƒ */
function openEditChoice() {
    const target = document.getElementById("editCode").value;
    const codes = getCodes();

    if (!/^\d{5}$/.test(target)) {
        alert("5ìë¦¬ í•™ë²ˆì„ ì…ë ¥í•˜ì„¸ìš”");
        return;
    }

    // [ìˆ˜ì •ë¨] ê°ì²´ ì•ˆì˜ code ì†ì„±ê³¼ ë¹„êµí•´ì•¼ í•©ë‹ˆë‹¤.
    // includes() -> some()ìœ¼ë¡œ ë³€ê²½
    const exists = codes.some(item => item.code === target);

    if (!exists) {
        alert("í•´ë‹¹ í•™ë²ˆ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤");
        return;
    }

    document.getElementById("editArea").classList.add("hidden");
    document.getElementById("editChoice").classList.remove("hidden");
}

/* ê¸°ë¡ ì‚­ì œ */
function deleteOne() {
    const target = document.getElementById("editCode").value;
    let codes = getCodes();

    // [ìˆ˜ì •ë¨] ì¡´ì¬ ì—¬ë¶€ í™•ì¸ ë¡œì§ ë³€ê²½
    const exists = codes.some(item => item.code === target);

    if (!exists) {
        alert("í•´ë‹¹ í•™ë²ˆì´ ì—†ìŠµë‹ˆë‹¤");
        return;
    }

    if (!confirm("ì‚­ì œí• ê¹Œìš”?")) return;

    // [ìˆ˜ì •ë¨] ì‚­ì œ ë¡œì§ ë³€ê²½: ê°ì²´ì˜ codeê°€ targetê³¼ ë‹¤ë¥¸ ê²ƒë§Œ ë‚¨ê¹€
    setCodes(codes.filter(item => item.code !== target));
    
    alert("ì‚­ì œ ì™„ë£Œ");
    closeAdmin();
}

/* ë‹¤ì‹œ ì°¸ì—¬ ê°€ëŠ¥ */
function enableRetry() {
    let codes = getCodes();
    const target = document.getElementById("editCode").value;

    // [ìˆ˜ì •ë¨] í•„í„°ë§ ë¡œì§ ë³€ê²½
    setCodes(codes.filter(item => item.code !== target));

    alert("ë‹¤ì‹œ ì°¸ì—¬ ê°€ëŠ¥í•˜ê²Œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤");
    closeAdmin();
}

/* í•™ë²ˆ ë³€ê²½ */
function changeCode() {
    const oldCode = document.getElementById("editCode").value;
    const newCode = document.getElementById("newCode").value;
    let codes = getCodes();

    if (!/^\d{5}$/.test(newCode)) {
        alert("ë³€ê²½í•  í•™ë²ˆì€ 5ìë¦¬ ìˆ«ìì—¬ì•¼ í•©ë‹ˆë‹¤");
        return;
    }

    // [ìˆ˜ì •ë¨] ì¤‘ë³µ í™•ì¸ ë¡œì§ ë³€ê²½
    if (codes.some(item => item.code === newCode)) {
        alert("ì´ë¯¸ ë“±ë¡ëœ í•™ë²ˆì…ë‹ˆë‹¤");
        return;
    }

    // [ìˆ˜ì •ë¨] ë°ì´í„° ë³€ê²½ ë¡œì§ ìˆ˜ì •
    // 1. ê¸°ì¡´ í•™ë²ˆ ì‚­ì œ
    let newCodes = codes.filter(item => item.code !== oldCode);
    
    // 2. ìƒˆ í•™ë²ˆ ì¶”ê°€ (ê°ì²´ í˜•íƒœë¡œ ì¶”ê°€í•´ì•¼ í•¨!)
    newCodes.push({ code: newCode, time: Date.now() });

    setCodes(newCodes);
    alert("í•™ë²ˆì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤");
    closeAdmin();
}


/* ê²°ê³¼ ì·¨í•© */
function openResult() {
    document.getElementById("adminMenu").classList.add("hidden");
    document.getElementById("resultArea").classList.remove("hidden");

    const list = document.getElementById("resultList");
    const codes = getCodes();

    if (codes.length === 0) {
        list.textContent = "ì•„ì§ ì…ë ¥ëœ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.";
        return;
    }

    list.innerHTML =
        "í•™ë²ˆ / ì…ë ¥ ì‹œê°<br>" +
        codes.map(c => {
            const d = new Date(c.time);
            const time =
                `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")} ` +
                `${String(d.getHours()).padStart(2,"0")}:${String(d.getMinutes()).padStart(2,"0")}:${String(d.getSeconds()).padStart(2,"0")}`;

            return `${c.code}  ${time}`;
        }).join("<br>");

}

function copyResult() {
    navigator.clipboard.writeText(
        document.getElementById("resultList").innerText
    );
    alert("ë³µì‚¬ ì™„ë£Œ");
}

function downloadCSV() {
    const codes = getCodes();
    if (codes.length === 0) return alert("ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤");

    let csv = "í•™ë²ˆ,ì…ë ¥ì‹œê°\n";
    codes.forEach(c => {
        const d = new Date(c.time);
        const t =
            `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")} ` +
            `${String(d.getHours()).padStart(2,"0")}:${String(d.getMinutes()).padStart(2,"0")}:${String(d.getSeconds()).padStart(2,"0")}`;
        csv += `${c.code},${t}\n`;
    });

    const blob = new Blob(["\uFEFF"+csv], { type:"text/csv;charset=utf-8;" });
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "ë³´ë¬¼ì°¾ê¸° ë¦¬ìŠ¤íŠ¸.csv";
    a.click();
}

</script>


<div id="credit">
    í–¥ì¼ê³ ë“±í•™êµ ì œ14ëŒ€ í•™ìƒìì¹˜íšŒ &lt;ì •ë³´ê¸°ë¡ì‹¤&gt;
    <span class="name">ì´ì„±ì›</span>
</div>


</body>
</html>



